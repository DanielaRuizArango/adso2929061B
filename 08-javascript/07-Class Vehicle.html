<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>07- Class Vehicle</title>
    <link rel="stylesheet" href="../css/styles.css" />
    <style>
        figure.character {
            background: url(images/character/bg-light.svg) no-repeat center;
            border-radius: 20px;
            padding: 0;
            position: relative;
            margin: 0;
            height: 600px;
            width: 350px;

            button.btn-mode {
                background: url(images/character/btn-mode-light.svg) no-repeat center;
                cursor: pointer;
                border: none;
                position: absolute;
                top: 6px;
                right: 13px;
                height: 40px;
                transition: transform 0.4s ease-in;
                width: 40px;

                &:hover {
                    transform: scale(1.1);
                }
            }
        }

        h4 {
            color: #333;
            font-weight: 400;
            font-size: 16px;
            text-align: center;
            position: absolute;
        }

        h4.title-name {
            left: 50%;
            transform: translateX(-50%);
            top: 108px;
        }

        h4.title-personality {
            top: 210px;
            left: 20px;
            width: 100px;
            font-size: 14px;
            text-align: center;
        }

        h4.title-color {
            left: 50%;
            transform: translateX(-50%);
            top: 210px;
            width: 100px;
            font-size: 14px;
        }

        h4.title-power {
            top: 210px;
            left: 230px;
            width: 100px;
            font-size: 14px;
            text-align: center;
        }

        button.btn-prev,
        button.btn-next {
            cursor: pointer;
            border: none;
            position: absolute;
            height: 40px;
            top: 98px;
            width: 40px;
            /* transition: transform 0.4s ease-in; */
        }

        button.btn-prev {
            background: url(images/character/btn-prev.svg) no-repeat center;
            left: 26px;
            top: 89px;

            /* &:hover {
                    transform: scale(1.1) translateX(-5px);
                  } */
        }

        button.btn-next {
            background: url(images/character/btn-next.svg) no-repeat center;
            right: 28px;
            top: 89px;

            /* &:hover {
                    transform: scale(1.1) translateX(5px);
                  } */
        }

        .show-data {
            animation: showData 1s ease-in forwards;
        }

        div.container {
            top: 250px;
            left: 32px;
            width: 284px;
            height: 239px;
            position: relative;
            overflow: hidden;
            border-radius: 12px;
        }

        /* Estilo para la imagen del personaje */
        .character-image {
            position: absolute;
            width: 100px;
            height: 120px;
            left: 50%;
            top: 70%;
            transform: translate(-50%, -50%);
            z-index: 10;
            transition: all 0.3s ease-in-out;
        }

        div.parallax {
            width: 100vw;
            height: 100vh;
            background-image: url(images/sky3.png);
            background-repeat: repeat-x;
            animation: moveBackground 50s linear infinite;
        }

        @keyframes moveBackground {
            from {
                background-position: 0 0;
            }

            to {
                background-position: 1000% 0;
            }
        }


        div.methods {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 269px auto 0 auto;
            gap: 15px;
            width: 288px;
            bottom: 45px;

            button {
                border: none;
                cursor: pointer;
                height: 40px;
                transition: transform 0.4s ease-in;
                width: 40px;

                &:hover {
                    transform: scale(1.05);
                }

                &.btn-power-on {
                    background: url(images/character/btn-power-on.svg) no-repeat center;
                }

                &.btn-forward {
                    background: url(images/character/btn-forward.svg) no-repeat center;
                }

                &.btn-stop {
                    background: url(images/character/btn-stop.svg) no-repeat center;
                }

                &.btn-backward {
                    background: url(images/character/btn-backward.svg) no-repeat center;
                }

                &.btn-power-off {
                    background: url(images/character/btn-power-off.svg) no-repeat center;
                }
            }
        }

        /* Dark Mode */
        figure.character.dark {
            background: url(images/character/bg-dark.svg) no-repeat center;

            button.btn-mode {
                background: url(images/character/btn-mode-dark.svg) no-repeat center;
                top: 10px;
                right: 13px;
                height: 35px
            }

            h4 {
                color: #000;
            }

            button.btn-prev {
                background: url(images/character/btn-prev-dark.svg) no-repeat center;
            }

            button.btn-next {
                background: url(images/character/btn-next-dark.svg) no-repeat center;
            }

            /* Cambiar el fondo del parallax en modo oscuro */
            .parallax {
                background-image: url(images/character/sky-night.png);
                top: 14px;
            }

            div.methods {
                button {
                    &.btn-power-on {
                        background: url(images/character/btn-power-on-dark.svg) no-repeat center;
                    }

                    &.btn-forward {
                        background: url(images/character/btn-forward-dark.svg) no-repeat center;
                    }

                    &.btn-stop {
                        background: url(images/character/btn-stop-dark.svg) no-repeat center;
                    }

                    &.btn-backward {
                        background: url(images/character/btn-backward-dark.svg) no-repeat center;
                    }

                    &.btn-power-off {
                        background: url(images/character/btn-power-off-dark.svg) no-repeat center;
                    }
                }
            }
        }

        @keyframes showData {
            0% {
                opacity: 0;
            }

            80% {
                opacity: 1;
            }

            90% {
                opacity: 0.8;
            }

            100% {
                opacity: 1;
            }
        }

        /* Shake animation for the character */
        @keyframes shake {
            0% {
                transform: translate(-50%, -50%) rotate(0deg);
            }

            10% {
                transform: translate(-50%, -50%) rotate(-1deg);
            }

            20% {
                transform: translate(-50%, -50%) rotate(1deg);
            }

            30% {
                transform: translate(-50%, -50%) rotate(0deg);
            }

            40% {
                transform: translate(-50%, -50%) rotate(1deg);
            }

            50% {
                transform: translate(-50%, -50%) rotate(-1deg);
            }

            60% {
                transform: translate(-50%, -50%) rotate(0deg);
            }

            70% {
                transform: translate(-50%, -50%) rotate(-1deg);
            }

            80% {
                transform: translate(-50%, -50%) rotate(1deg);
            }

            90% {
                transform: translate(-50%, -50%) rotate(0deg);
            }

            100% {
                transform: translate(-50%, -50%) rotate(-1deg);
            }
        }

        .character-image.shake {
            animation: shake 0.5s infinite;
        }
    </style>
</head>

<body class="js">
    <nav>
        <a href="index.html">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                <path fill="#ffffff"
                    d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z" />
            </svg>
        </a>
    </nav>
    <main>
        <header>
            <h1>07- Class Vehicle</h1>
            <p>Create and manipulate a Class Vehicle with properties.</p>
        </header>
        <section>
            <figure class="character">
                <button class="btn-mode"></button>
                <h4 class="title-name"></h4>
                <h4 class="title-personality"></h4>
                <h4 class="title-color"></h4>
                <h4 class="title-power"></h4>
                <button class="btn-prev"></button>
                <button class="btn-next"></button>
                <div class="container">
                    <div class="parallax"></div>
                    <img class="character-image" alt="Character">
                </div>
                <div class="methods">
                    <button class="btn-power-on"></button>
                    <button class="btn-forward"></button>
                    <button class="btn-stop"></button>
                    <button class="btn-backward"></button>
                    <button class="btn-power-off"></button>
                </div>
            </figure>
        </section>
    </main>
    <script>
        // Object
        const character = {
            attrs: [
                {
                    name: "Blossom",
                    personality: "Intelligent",
                    color: "Pink",
                    power: "Ice Breath",
                    image: "images/character/blossom1.svg",
                    imageOn: "images/character/blossom2.svg",
                    imageForward: "images/character/blossom3.svg",
                    imageBackward: "images/character/blossom4.svg"
                },
                {
                    name: "Bubbles",
                    personality: "Sweet",
                    color: "Sky Blue",
                    power: "X-ray Vision",
                    image: "images/character/bubbles1.svg",
                    imageOn: "images/character/bubbles2.svg",
                    imageForward: "images/character/bubbles3.svg",
                    imageBackward: "images/character/bubbles4.svg"
                },
                {
                    name: "Buttercup",
                    personality: "Intrepid",
                    color: "Light Green",
                    power: "Fireball",
                    image: "images/character/buttercup1.svg",
                    imageOn: "images/character/buttercup2.svg",
                    imageForward: "images/character/buttercup3.svg",
                    imageBackward: "images/character/buttercup4.svg"
                },
            ],
        };

        // Elements
        const vCharacter = document.querySelector(".character");
        const tName = document.querySelector(".title-name");
        const tPersonality = document.querySelector(".title-personality");
        const tColor = document.querySelector(".title-color");
        const tPower = document.querySelector(".title-power");
        const characterImg = document.querySelector(".character-image");
        // Buttons
        const btnMode = document.querySelector(".btn-mode");
        const btnPrev = document.querySelector(".btn-prev");
        const btnNext = document.querySelector(".btn-next");
        const btnPowerOn = document.querySelector(".btn-power-on");
        const btnPowerOff = document.querySelector(".btn-power-off");
        const btnForward = document.querySelector(".btn-forward");
        const btnStop = document.querySelector(".btn-stop");
        const btnBackward = document.querySelector(".btn-backward");
        const parallaxElement = document.querySelector(".parallax");

        // Variables
        let inx = 0;
        btnPrev.style.opacity = "0.2";
        btnPrev.style.pointerEvents = "none";

        // Dark Mode
        const darkMode = window.matchMedia("(prefers-color-scheme: dark)");
        darkMode.addListener(darkModeChange);

        function darkModeChange(dm) {
            if (dm.matches) {
                vCharacter.classList.add("dark");
            } else {
                vCharacter.classList.remove("dark");
            }
        }
        darkModeChange(darkMode);

        // Events
        btnMode.addEventListener("click", () => {
            vCharacter.classList.toggle("dark");
        });

        // Class
        class Character {
            constructor(name, personality, color, power, image, imageOn, imageForward, imageBackward) {
                this.name = name;
                this.personality = personality;
                this.color = color;
                this.power = power;
                this.image = image;
                this.imageOn = imageOn;
                this.imageForward = imageForward;
                this.imageBackward = imageBackward;
                this.isOn = false;
                this.isMovingForward = false;
                this.isMovingBackward = false;
                this.isStopped = false;
            }

            displayData() {
                tName.textContent = this.name;
                tName.classList.add("show-data");
                tPersonality.textContent = this.personality;
                tPersonality.classList.add("show-data");
                tColor.textContent = this.color;
                tColor.classList.add("show-data");
                tPower.textContent = this.power;
                tPower.classList.add("show-data");

                // Actualizar la imagen del personaje
                characterImg.src = this.image;
                characterImg.classList.add("show-data");

                setTimeout(function () {
                    tName.classList.remove("show-data");
                    tPersonality.classList.remove("show-data");
                    tColor.classList.remove("show-data");
                    tPower.classList.remove("show-data");
                    characterImg.classList.remove("show-data");
                }, 1000);
            }
            powerOn() {
                if (!this.isOn) {
                    this.isOn = true;
                    console.log("Its On");
                    characterImg.src = this.imageOn;
                    characterImg.classList.add("shake");
                } else {
                    console.log("Already On");
                }
            }
            powerOff() {
                if (this.isOn) {
                    this.isOn = false;
                    this.isMovingForward = false;
                    this.isMovingBackward = false;
                    this.isStopped = false;
                    console.log("Its Off");
                    characterImg.src = this.image;
                    characterImg.classList.remove("shake");
                    // Detener la animación del parallax cuando se apaga
                    parallaxElement.style.animationPlayState = "paused";
                }
            }
            moveForward() {
                if (this.isOn && !this.isMovingForward) {
                    this.isMovingForward = true;
                    this.isStopped = false;
                    console.log("Moving Forward");
                    characterImg.src = this.imageForward;
                    // Ensure background animation is running
                    parallaxElement.style.animationPlayState = "running";
                } else if (!this.isOn) {
                    console.log("Need to power on first");
                } else {
                    console.log("Already moving forward");
                }
            }
            stop() {
                if (this.isOn) {
                    this.isMovingForward = false;
                    this.isStopped = true;
                    console.log("Stopped");
                    characterImg.src = this.imageOn;
                    // Pause background animation
                    parallaxElement.style.animationPlayState = "paused";
                } else {
                    console.log("Need to power on first");
                }
            }
            moveBackward() {
                if (this.isOn && !this.isMovingBackward) {
                    this.isMovingBackward = true;
                    this.isMovingForward = false;
                    this.isStopped = false;
                    console.log("Moving Backward");
                    characterImg.src = this.imageBackward || this.imageOn; // Usar imageOn como fallback
                    // Ensure background animation is running in reverse
                    parallaxElement.style.animationDirection = "reverse";
                    parallaxElement.style.animationPlayState = "running";
                } else if (!this.isOn) {
                    console.log("Need to power on first");
                } else {
                    console.log("Already moving backward");
                }
            }
        }

        // Define girl only once
        const girl = new Character(
            character.attrs[inx].name,
            character.attrs[inx].personality,
            character.attrs[inx].color,
            character.attrs[inx].power,
            character.attrs[inx].image,
            character.attrs[inx].imageOn,
            character.attrs[inx].imageForward,
            character.attrs[inx].imageBackward
        );
        girl.displayData();

        btnNext.addEventListener("click", () => {
            if (inx < character.attrs.length - 1) {
                ++inx;
                btnPrev.style.opacity = "1";
                btnPrev.style.pointerEvents = "all";
                girl.name = character.attrs[inx].name;
                girl.personality = character.attrs[inx].personality;
                girl.color = character.attrs[inx].color;
                girl.power = character.attrs[inx].power;
                girl.image = character.attrs[inx].image;
                girl.imageOn = character.attrs[inx].imageOn;
                girl.imageForward = character.attrs[inx].imageForward;
                girl.imageBackward = character.attrs[inx].imageBackward;
                girl.displayData();
                if (inx == character.attrs.length - 1) {
                    btnNext.style.opacity = "0.2";
                    btnNext.style.pointerEvents = "none";
                }
                // Reset image based on current state
                if (!girl.isOn) {
                    characterImg.src = girl.image;
                } else if (girl.isMovingForward) {
                    characterImg.src = girl.imageForward;
                } else if (girl.isMovingBackward) {
                    characterImg.src = girl.imageBackward || girl.imageOn;
                } else {
                    characterImg.src = girl.imageOn;
                }
            }
        });

        btnPrev.addEventListener("click", () => {
            if (inx > 0) {
                --inx;
                btnNext.style.opacity = "1";
                btnNext.style.pointerEvents = "all";
                girl.name = character.attrs[inx].name;
                girl.personality = character.attrs[inx].personality;
                girl.color = character.attrs[inx].color;
                girl.power = character.attrs[inx].power;
                girl.image = character.attrs[inx].image;
                girl.imageOn = character.attrs[inx].imageOn;
                girl.imageForward = character.attrs[inx].imageForward;
                girl.imageBackward = character.attrs[inx].imageBackward;
                girl.displayData();
                if (inx == 0) {
                    btnPrev.style.opacity = "0.2";
                    btnPrev.style.pointerEvents = "none";
                }
                // Reset image based on current state
                if (!girl.isOn) {
                    characterImg.src = girl.image;
                } else if (girl.isMovingForward) {
                    characterImg.src = girl.imageForward;
                } else if (girl.isMovingBackward) {
                    characterImg.src = girl.imageBackward || girl.imageOn;
                } else {
                    characterImg.src = girl.imageOn;
                }
            }
        });

        // Add event listeners for power buttons
        btnPowerOn.addEventListener("click", () => {
            girl.powerOn();
        });

        btnPowerOff.addEventListener("click", () => {
            girl.powerOff();
        });

        btnForward.addEventListener("click", () => {
            girl.moveForward();
        });

        btnStop.addEventListener("click", () => {
            girl.stop();
        });

        btnBackward.addEventListener("click", () => {
            girl.moveBackward();
        });
    </script>
</body>

</html>